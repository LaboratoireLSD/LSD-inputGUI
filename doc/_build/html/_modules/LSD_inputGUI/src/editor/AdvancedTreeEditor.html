<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>LSD_inputGUI.src.editor.AdvancedTreeEditor &mdash; LSD-inputGUI 3.5 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '3.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="LSD-inputGUI 3.5 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">LSD-inputGUI 3.5 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for LSD_inputGUI.src.editor.AdvancedTreeEditor</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: AdvancedTreeEditor</span>

<span class="sd">.. codeauthor::  Mathieu Gagnon &lt;mathieu.gagnon.10@ulaval.ca&gt;</span>

<span class="sd">:Created on: 2010-01-06</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtXml</span>
<span class="kn">from</span> <span class="nn">model.PrimitiveModel</span> <span class="kn">import</span> <span class="n">Primitive</span> <span class="k">as</span> <span class="n">treeEditorPmtModel</span>
<span class="kn">from</span> <span class="nn">model.LocalVariableModel</span> <span class="kn">import</span> <span class="n">LocVarsModel</span>
<span class="kn">from</span> <span class="nn">editor.MedList</span> <span class="kn">import</span> <span class="n">MedListView</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtSvg</span> <span class="kn">import</span> <span class="n">QSvgGenerator</span>

<span class="c">#Global variables to modify the look of the application</span>
<span class="n">glob_Width</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">glob_Height</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">glob_RowDist</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">glob_ColDist</span> <span class="o">=</span> <span class="mi">55</span>

<div class="viewcode-block" id="MedTreeView"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView">[docs]</a><span class="k">class</span> <span class="nc">MedTreeView</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is responsible of controlling the refresh of a QGraphicsScene and the interactions of the user with the scene.</span>
<span class="sd">    Most of it is reimplemented from QGraphicsView.</span>
<span class="sd">    This class allows a user-friendly display of a xml file.</span>
<span class="sd">    This class implements tools to allow quick and easy modification of xml files.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domNode</span><span class="o">=</span><span class="n">QtXml</span><span class="o">.</span><span class="n">QDomNode</span><span class="p">(),</span> <span class="n">mainWindow</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor.</span>
<span class="sd">        </span>
<span class="sd">        :param domNode: Optional - xml dom node, root of the xml tree we want to display.</span>
<span class="sd">        :param mainWindow: Optional - Application&#39;s mainWindow.</span>
<span class="sd">        :type domNode: PyQt4.QtXml.QDomNode</span>
<span class="sd">        :type mainWindow: :class:`.MainWindow`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#Initialize scene</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setScene</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsScene</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">setBackgroundBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">173</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">250</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span> <span class="o">=</span> <span class="n">mainWindow</span>
        <span class="c">#Dom Node of the tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dom</span> <span class="o">=</span> <span class="n">domNode</span>
        <span class="c">#Pointer to local variable model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c">#Drawing flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptDrops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="c">#Variable to emulate focused Item(needed cause focused Item loses focus when we click out of the scene)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="p">)</span>
        <span class="c">#Stack for undo/redo commands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoStack</span><span class="p">()</span>
        
        <span class="c">#Loading and updating View</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        
    
    <span class="k">def</span> <span class="nf">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">parentRow</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This is a recursive function.</span>
<span class="sd">        Constructs the graphical elements that will be displayed.</span>
<span class="sd">        </span>
<span class="sd">        :param :class:`.PrimitiveModel.Primitive` primitive: Root of the xml dom we want to display.</span>
<span class="sd">        :param Int row:</span>
<span class="sd">        :param Int column:</span>
<span class="sd">        :param parentRow: Not used</span>
<span class="sd">        :return: Pair (Int, :class:`.MedTreeItem`).</span>
<span class="sd">        &#39;&#39;&#39;</span>              
        <span class="c">#Initialize relative row number(relative row is the row in the subtree)</span>
        <span class="n">relRow</span><span class="o">=</span><span class="mi">0</span>

        <span class="c">#if primitive has children</span>
        <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">countChildren</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="c">#Create graphical object</span>
            <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="c">#Start at 0 if it is root node</span>
                <span class="n">newGraphItem</span> <span class="o">=</span> <span class="n">MedTreeItem</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="o">*</span><span class="n">glob_ColDist</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">,</span><span class="n">glob_Height</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newGraphItem</span> <span class="o">=</span> <span class="n">MedTreeItem</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="p">,</span><span class="n">row</span><span class="o">*</span><span class="n">glob_ColDist</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">,</span><span class="n">glob_Height</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>

            <span class="c">#Make a link between graphic item and model item via a primitive</span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">setPrimitive</span><span class="p">(</span><span class="n">primitive</span><span class="p">)</span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;ErrorFound()&quot;</span><span class="p">),</span><span class="n">newGraphItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;ErrorFound()&quot;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">updateErrorLog</span><span class="p">)</span>
            <span class="c">#Testing if root node</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">primitive</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="c">#Drawing line to parent</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">row</span> <span class="p">:</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">)),</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">guiGetBranchInfo</span><span class="p">():</span>
                    <span class="c">#Draw Comment if needed</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="n">primitive</span><span class="o">.</span><span class="n">guiGetBranchInfo</span><span class="p">(),</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;Helvetica&quot;</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>          
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextWidth</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextInteractionFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoTextInteraction</span><span class="p">)</span>
                <span class="c">#Draw choice list</span>
                <span class="c">#newGraphItem.choiceList = MedTreeArrow(QtCore.QPointF(125,38),newGraphItem)</span>
                
            <span class="c">#Draw Cross Item   </span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="n">MedTreeCross</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">newGraphItem</span><span class="p">)</span>
            
            <span class="c">#Cycle through all children</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">primitive</span><span class="o">.</span><span class="n">countChildren</span><span class="p">()):</span>
                <span class="c">#Recursion+add number of row</span>
                <span class="n">rowInc</span><span class="p">,</span> <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="n">primitive</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">relRow</span><span class="p">,</span><span class="n">column</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">newGraphItem</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="n">primitive</span><span class="o">.</span><span class="n">countChildren</span><span class="p">()</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetBranchTag</span><span class="p">():</span>   
                        <span class="c">#Draw branch tag if needed</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">branchTagEditor</span> <span class="o">=</span> <span class="n">MedTreeEditableBranchTag</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">item</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetBranchTag</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">relRow</span><span class="o">+=</span><span class="n">rowInc</span>
            
            <span class="c">#Draw Line to children</span>
            <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">countChildren</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">newGraphItem</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="n">newGraphItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                <span class="n">newGraphItem</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
            <span class="c">#Draw asterisk if items has comment</span>
            <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">userComment</span><span class="p">:</span><span class="c">#</span>
                <span class="n">newAsteriskItem</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">))</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">18</span><span class="p">))</span>
                <span class="n">newGraphItem</span><span class="o">.</span><span class="n">asterisk</span> <span class="o">=</span> <span class="n">newAsteriskItem</span>
                
            <span class="c">#Return relative row and graphical item</span>
            <span class="k">return</span> <span class="n">relRow</span><span class="p">,</span> <span class="n">newGraphItem</span>
        
        <span class="c">#Simple case : Primitive has no child    </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Create graphical object</span>
            <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="c">#Start at 0 if it is root node</span>
                <span class="n">newGraphItem</span> <span class="o">=</span> <span class="n">MedTreeItem</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">row</span><span class="o">*</span><span class="n">glob_ColDist</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">,</span><span class="n">glob_Height</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newGraphItem</span> <span class="o">=</span> <span class="n">MedTreeItem</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="p">,</span><span class="n">row</span><span class="o">*</span><span class="n">glob_ColDist</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">,</span><span class="n">glob_Height</span><span class="p">),</span><span class="bp">self</span><span class="p">)</span>
            <span class="c">#Make a link between graphic item and model item via a primitive</span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">setPrimitive</span><span class="p">(</span><span class="n">primitive</span><span class="p">)</span>
            <span class="n">newGraphItem</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;ErrorFound()&quot;</span><span class="p">),</span><span class="n">newGraphItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;ErrorFound()&quot;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">updateErrorLog</span><span class="p">)</span>
            <span class="c">#Testing if root node</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">primitive</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="c">#Drawing line to parent</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">row</span> <span class="p">:</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">)),</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">guiGetBranchInfo</span><span class="p">():</span>
                    <span class="c">#Draw Info if needed</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="n">primitive</span><span class="o">.</span><span class="n">guiGetBranchInfo</span><span class="p">(),</span><span class="n">newGraphItem</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;Helvetica&quot;</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>          
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextWidth</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
                    <span class="n">newGraphItem</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextInteractionFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoTextInteraction</span><span class="p">)</span>
                <span class="c">#Draw choice list</span>
                <span class="c">#newGraphItem.choiceList = MedTreeArrow(QtCore.QPointF(125,38),newGraphItem)</span>
            
            <span class="c">#Draw asterisk if items has comment</span>
            <span class="k">if</span> <span class="n">primitive</span><span class="o">.</span><span class="n">userComment</span><span class="p">:</span><span class="c">#</span>
                <span class="n">newAsteriskItem</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="n">newGraphItem</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">))</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">18</span><span class="p">))</span>
                <span class="n">newGraphItem</span><span class="o">.</span><span class="n">asterisk</span> <span class="o">=</span> <span class="n">newAsteriskItem</span>
            
            <span class="c">#Return relative row and graphical item</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newGraphItem</span>
        
<div class="viewcode-block" id="MedTreeView.addChild"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.addChild">[docs]</a>    <span class="k">def</span> <span class="nf">addChild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a child at the end of the current item.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandAddChild</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="MedTreeView.addSiblingAfter"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.addSiblingAfter">[docs]</a>    <span class="k">def</span> <span class="nf">addSiblingAfter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a sibling just after the current item.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandAddSA</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
                </div>
<div class="viewcode-block" id="MedTreeView.addSiblingBefore"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.addSiblingBefore">[docs]</a>    <span class="k">def</span> <span class="nf">addSiblingBefore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a sibling just before the current item.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandAddSB</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
                </div>
<div class="viewcode-block" id="MedTreeView.addMultipleChildren"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.addMultipleChildren">[docs]</a>    <span class="k">def</span> <span class="nf">addMultipleChildren</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numChildToAdd</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add multiple children at the end of the current item.</span>
<span class="sd">        </span>
<span class="sd">        :param Int numChildToAdd: Number of children to add.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandAddMC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numChildToAdd</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="MedTreeView.copy"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Simple copy function.</span>
<span class="sd">        Looks if a MedTreeItem is currently selected and pastes it(and all its subtree) to MainEditorWindow&#39;s clipboard variable.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="MedTreeView.paste"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.paste">[docs]</a>    <span class="k">def</span> <span class="nf">paste</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Simple paste function.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
                </div>
<div class="viewcode-block" id="MedTreeView.cut"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.cut">[docs]</a>    <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Simple cut function.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandCut</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="MedTreeView.save"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Saves DOM.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">parentNode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">parentNode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">parentNode</span><span class="p">()</span><span class="o">.</span><span class="n">replaceChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">()),</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dom</span> <span class="o">=</span> <span class="n">parentNode</span><span class="o">.</span><span class="n">firstChild</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveLocals</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="MedTreeView.saveLocals"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.saveLocals">[docs]</a>    <span class="k">def</span> <span class="nf">saveLocals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Saves Local Variables.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span><span class="o">.</span><span class="n">baseModel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">parentNode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="MedTreeView.getLocVarModel"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.getLocVarModel">[docs]</a>    <span class="k">def</span> <span class="nf">getLocVarModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return Local Variable Model associated with this tree.</span>
<span class="sd">        Create one if it doesn&#39;t exist.</span>
<span class="sd">        </span>
<span class="sd">        :return: :class:`.LocVarsModel`.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span> <span class="o">=</span> <span class="n">LocVarsModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">parentNode</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">locVarModel</span>
    </div>
<div class="viewcode-block" id="MedTreeView.dragEnterEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.dragEnterEvent">[docs]</a>    <span class="k">def</span> <span class="nf">dragEnterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of virtual function QtGraphicsView.dragEnterEvent(self,event).</span>
<span class="sd">        Ensure event come from a MedListView.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">(),</span><span class="n">MedListView</span><span class="p">):</span>
            <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clearFocus</span><span class="p">()</span>
            <span class="n">event</span><span class="o">.</span><span class="n">acceptProposedAction</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MedTreeView.dragLeaveEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.dragLeaveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">dragLeaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of virtual function QtGraphicsView.dragLeaveEvent(self,event).</span>
<span class="sd">        This function just ignores the event. If it doesn&#39;t ignore it, Qt will complain receiving a dragLeaveEvent before a dragEnterEvent.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="MedTreeView.dropEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.dropEvent">[docs]</a>    <span class="k">def</span> <span class="nf">dropEvent</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of virtual function QtGraphicsView.droptEvent(self,event).</span>
<span class="sd">        Takes MimeData previously created by the drag event from a MedList.\n</span>
<span class="sd">        Main idea : </span>
<span class="sd">                    - do nothing if the drop operation comes from a drag event initiated by self(medTreeView).</span>
<span class="sd">                    - ensure the drop event landed on a MedTreeItem, a graphical representation of a primitive.</span>
<span class="sd">                    - Create CommandDropChild, that will take care of the model and tree management.</span>
<span class="sd">                    </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c">#Source is self : do nothing</span>
            <span class="n">event</span><span class="o">.</span><span class="n">setDropAction</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">MoveAction</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Source is other : update Tree</span>
            <span class="c">#Look if there is an object under the mouse Pointer</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())):</span>
                <span class="n">replacedItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span>
                <span class="c">#Look if this object belongs to model</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">replacedItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
                    <span class="c">#Test if it is root Node</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">replacedItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                        <span class="c">#clear Current item</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span> <span class="n">MedTreeItem</span><span class="p">):</span>
                            <span class="c">#Make sure last current Item is repainted to avoid item being rendered as still selected</span>
                            <span class="c">#Do it before tree is modified, because if modifying tree trashes this item a runtime error will occur</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                    <span class="c">#Create and push CommandDropChild on undo stack</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">undoStack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">CommandDropChild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replacedItem</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">mimeData</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">updateDirtyState</span><span class="p">()</span>
                    
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">dropEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="MedTreeView.keyPressEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of virtual function QtGraphicsView.dragLeaveEvent(self,event).</span>
<span class="sd">        Test which key(s) has been pressed and call corresponding function.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_P</span><span class="p">:</span>
                <span class="c">#Code to save self.dom(a QDomNode) in a xml file for debugging</span>
                <span class="n">domToSave</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">()</span>
                <span class="n">FilePointer</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QFile</span><span class="p">(</span><span class="s">&quot;Tests/EditorTest.xml&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">FilePointer</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QIODevice</span><span class="o">.</span><span class="n">ReadWrite</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QIODevice</span><span class="o">.</span><span class="n">Truncate</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;File cannot be opened&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">domToSave</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QTextStream</span><span class="p">(</span><span class="n">FilePointer</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;print Succeeded&quot;</span><span class="p">)</span>
            <span class="c">#Dump debugging actions</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_X</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">dumpModelInfos</span><span class="p">()</span>
            <span class="c">#Call cut function</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Delete</span> <span class="ow">or</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backspace</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">(),</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cut</span><span class="p">()</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            
            <span class="c">#Allow Tree Navigation using arrow keys</span>
            <span class="c">#Update manipulations need to be done or else painting is not done until a refresh is requested by Qt&#39;s paint system</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Up</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">:</span>
                        <span class="n">lUpdatePtr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">centerOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                        <span class="n">lUpdatePtr</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Down</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">:</span>
                        <span class="n">lUpdatePtr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">centerOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                        <span class="n">lUpdatePtr</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Left</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">():</span>
                    <span class="n">lUpdatePtr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">centerOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                    <span class="n">lUpdatePtr</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Key_Right</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
                    <span class="n">lUpdatePtr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">centerOn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                    <span class="n">lUpdatePtr</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
        
        </div>
<div class="viewcode-block" id="MedTreeView.mouseDoubleClickEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.mouseDoubleClickEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseDoubleClickEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView&#39;.mouseDoubleClickEvent(self,event) virtual function.</span>
<span class="sd">        Open a new MedTreeView if clicked primitive has a doubleClickBehavior(TokenCallProcess and TokenPushProcess for the moment).</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiDoubleClickBehavior</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">openTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">getAttributeByName</span><span class="p">(</span><span class="s">&quot;inLabel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">return</span>
        
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">mouseDoubleClickEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
        
                   </div>
<div class="viewcode-block" id="MedTreeView.mousePressEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView.mousePressEvent(self,event) virtual function.\n</span>
<span class="sd">        Main idea : a mouse press event can be performed to choose a primitive so the user can see its attributes(properties).</span>
<span class="sd">        Hence, call an update on the properties/error/definition/comment tabs.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#First, look if item is a proxy widget</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">(),</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsProxyWidget</span><span class="p">):</span>
            <span class="c">#Find its parent(in our case, the comboBox&#39;s proxy)</span>
            <span class="n">proxyToDelete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">()</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">():</span>
                <span class="c">#User clicked out of popup list, delete proxy immediately</span>
                <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">proxyToDelete</span><span class="p">)</span>
                <span class="k">return</span>
        
        
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">(),</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">focusItem</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="c">#Call a refresh</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">paintHook</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">updateProperties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateComAndDef</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateErrorLog</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightButton</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">popNodeMenu</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">globalPos</span><span class="p">())</span>
    </div>
<div class="viewcode-block" id="MedTreeView.wheelEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.wheelEvent">[docs]</a>    <span class="k">def</span> <span class="nf">wheelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView.wheelEvent(self,event) virtual function.</span>
<span class="sd">        Allow Ctrl-wheel to scroll horizontally, else do as usual.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsView documentation for more information</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">singleStep</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">singleStep</span><span class="p">())</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsView</span><span class="o">.</span><span class="n">wheelEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span> 
            </div>
    <span class="k">def</span> <span class="nf">_updateTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modifiedItem</span><span class="p">,</span> <span class="n">assocPmt</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Updates modifiedItem&#39;s subTree.</span>
<span class="sd">        </span>
<span class="sd">        :param :class:`.MedTreeItem` modifiedItem: MedTreeItem being modified</span>
<span class="sd">        :param assocPmt: The primitive associated with the modified object</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">modifiedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c">#First primitive of the tree, then reload Tree</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">newSubTree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="n">assocPmt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">newSubTree</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">newSubTree</span>
        
        <span class="c">#Gather information about current positions of the graphical items</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">modifiedItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">()</span>
        <span class="n">column</span>  <span class="o">=</span> <span class="n">modifiedItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">()</span>
        <span class="n">parentRow</span> <span class="o">=</span> <span class="n">modifiedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">getRow</span><span class="p">()</span>
        
        <span class="c">#Reload modified Item and its subtree</span>
        <span class="n">modifiedItem</span><span class="o">.</span><span class="n">collapseSubTree</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">newSubTree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="n">assocPmt</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">parentRow</span><span class="p">)</span>
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">collapseSubTree</span><span class="p">()</span>
        <span class="c">#Set Parent Item and update parent&#39;s list of graphical primitives</span>
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">modifiedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">(),</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">modifiedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="n">modifiedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">modifiedItem</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newSubTree</span> 
        
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">stackBefore</span><span class="p">(</span><span class="n">modifiedItem</span><span class="p">)</span>
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="n">modifiedItem</span><span class="o">.</span><span class="n">zValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">modifiedItem</span><span class="p">)</span>
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">expandSubTree</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newSubTree</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">newSubTree</span>
    
    <span class="k">def</span> <span class="nf">_updateTreeHook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Called when a medTreeItem is changed using the comboBox method</span>
<span class="sd">        Main idea : do like the normal _updateTree but delete arrow first to avoid seg faults</span>
<span class="sd">        </span>
<span class="sd">        :param text: name of the primitive we want this node to become</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">proxyParent</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="n">replacedItem</span> <span class="o">=</span> <span class="n">arrow</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
        <span class="n">realPmtName</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">dictRealNames</span><span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()]</span>
        <span class="c">#Hide arrow before deleting it or else it pops top corner left before getting trashed</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="n">pmtPos</span> <span class="o">=</span> <span class="n">replacedItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="n">replacedItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
        <span class="n">replacedItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiSetModelData</span><span class="p">(</span><span class="n">realPmtName</span><span class="p">,</span><span class="n">pmtPos</span><span class="p">)</span>
        <span class="c">#Update Tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateTree</span><span class="p">(</span><span class="n">replacedItem</span><span class="p">,</span><span class="n">replacedItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
    
<div class="viewcode-block" id="MedTreeView.generalUpdate"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.generalUpdate">[docs]</a>    <span class="k">def</span> <span class="nf">generalUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Call three update functions :</span>
<span class="sd">            - Update properties &lt;:meth:`.MedTreeView.updateProperties`&gt;</span>
<span class="sd">            - Update comments and definitions &lt;:meth:`.MedTreeView.updateComAndDef`&gt;</span>
<span class="sd">            - Update error log &lt;:meth:`.MedTreeView.updateErrorLog`&gt;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateProperties</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateComAndDef</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateErrorLog</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="MedTreeView.updateProperties"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.updateProperties">[docs]</a>    <span class="k">def</span> <span class="nf">updateProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create and show the widgets that contain the information about currentItem&#39;s primitive attributes</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#Clear the current tab widget containing the properties of the last selected item</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;Properties&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">removeTab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="c">#Create a new one</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">propertyWidget</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">()</span>
            
            <span class="c">#Get the attribute layout from the primitive</span>
            <span class="n">tmpPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span>
            <span class="n">layoutAttributes</span> <span class="o">=</span> <span class="n">tmpPmt</span><span class="o">.</span><span class="n">guiGetAttrLayout</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">propertyWidget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layoutAttributes</span><span class="p">)</span>
            
            <span class="c">#Add widget to the mainEditorFrame corresponding tab widget</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">insertTab</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">propertyWidget</span><span class="p">,</span><span class="s">&quot;Properties&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="MedTreeView.updateComAndDef"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.updateComAndDef">[docs]</a>    <span class="k">def</span> <span class="nf">updateComAndDef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create and show the widgets that contain the definition of the currently selected variable and the comment associated to it, if any</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tab_Widget_4</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="n">commentTab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiCreateEditor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tab_Widget_4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">commentTab</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;textChanged()&quot;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">manageAsterisk</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="MedTreeView.updateErrorLog"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.updateErrorLog">[docs]</a>    <span class="k">def</span> <span class="nf">updateErrorLog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create the error log located next to the Properties tab</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;Errors&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">removeTab</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">validityEventsList</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">errorLogWidget</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QListWidget</span><span class="p">()</span>  
                <span class="k">for</span> <span class="n">events</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">validityEventsList</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">errorLogWidget</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">events</span><span class="o">.</span><span class="n">generateEventMsg</span><span class="p">())</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_3</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errorLogWidget</span><span class="p">,</span> <span class="s">&quot;Errors&quot;</span><span class="p">)</span>   
        </div>
<div class="viewcode-block" id="MedTreeView.updateDirtyState"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.updateDirtyState">[docs]</a>    <span class="k">def</span> <span class="nf">updateDirtyState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Look if file is dirty. It means, if modifications have been made since the last save.\n</span>
<span class="sd">        If so, add asterisk(*) to tab&#39;s name</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">currText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">tabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_checkForSimilarDoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dom</span><span class="p">):</span>
            <span class="n">currText</span> <span class="o">=</span> <span class="n">currText</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;*&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">currText</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabWidget_2</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">currText</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="MedTreeView.printSVGFile"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.printSVGFile">[docs]</a>    <span class="k">def</span> <span class="nf">printSVGFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">svgFilePath</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Prints a .svg of the tree if the parameter *svgFilePath* is not empty.</span>
<span class="sd">        </span>
<span class="sd">        :param svgFilePath: filePath we want the picture to be saved to.</span>
<span class="sd">        :type svgFilePath: String.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">svgFilePath</span><span class="p">:</span>
            <span class="n">svgFilePath</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">&quot;Save SVG file&quot;</span><span class="p">),</span>
                                                            <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">&quot;SVG files (*.svg);;All files (*);;&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">svgFilePath</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;svg&quot;</span><span class="p">:</span>
            <span class="n">svgFilePath</span> <span class="o">+=</span> <span class="s">&quot;.svg&quot;</span>
        
        <span class="n">blackAndWhite</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">&quot;Picture options&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s">&quot;Colors&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="p">[</span><span class="s">&quot;RGB&quot;</span><span class="p">,</span> <span class="s">&quot;Grayscale&quot;</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">blackAndWhite</span> <span class="o">==</span> <span class="s">&quot;RGB&quot;</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">QSvgGenerator</span><span class="p">()</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setFileName</span><span class="p">(</span><span class="n">svgFilePath</span><span class="p">)</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setViewBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Grayscale painting requires manipulations, since Qt doesn&#39;t offer any built-in functions to paint in grayscale</span>
            <span class="n">tmpImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB32</span><span class="p">)</span>
            <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">tmpImage</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">setBackgroundBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">painter</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">setBackgroundBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">173</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">250</span><span class="p">)))</span>
            <span class="n">grayScaleImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="p">(</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB32</span><span class="p">)</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QProgressDialog</span><span class="p">(</span><span class="s">&quot;Converting to gray scale&quot;</span><span class="p">,</span><span class="s">&quot;Cancel&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">width</span><span class="p">()):</span>
                <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">height</span><span class="p">()):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="p">((</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">4278190080</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span>\
                            <span class="mf">0.59</span> <span class="o">*</span> <span class="p">((</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">4278190080</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span> <span class="o">+</span>\
                            <span class="mf">0.11</span> <span class="o">*</span> <span class="p">((</span><span class="n">tmpImage</span><span class="o">.</span><span class="n">pixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">4278190080</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">255</span><span class="p">)</span>
                    <span class="n">pixelColor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qRgb</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="n">grayScaleImage</span><span class="o">.</span><span class="n">setPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pixelColor</span><span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="c">#Use python byte for fast access</span>
<span class="c">#            imgData = []</span>
<span class="c">#            for x in range(0,tmpImage.width()):</span>
<span class="c">#                for y in range(0,tmpImage.height()):</span>
<span class="c">#                    value = 0.3*((tmpImage.pixel(x,y)-4278190080)&gt;&gt;16)+0.59*((tmpImage.pixel(x,y)-4278190080)&gt;&gt;8&amp;255)+0.11*((tmpImage.pixel(x,y)-4278190080)&amp;255)</span>
<span class="c">#                    imgData.extend([255,int(value),int(value),int(value)])</span>
<span class="c">#            grayScaleImage = QtGui.QImage(bytes(imgData),tmpImage.width(),tmpImage.height(),QtGui.QImage.Format_RGB32)</span>
            <span class="c">#Save file</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">QSvgGenerator</span><span class="p">()</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setFileName</span><span class="p">(</span><span class="n">svgFilePath</span><span class="p">)</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">grayScaleImage</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">grayScaleImage</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
            <span class="n">gen</span><span class="o">.</span><span class="n">setViewBox</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grayScaleImage</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="n">grayScaleImage</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
            <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grayScaleImage</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="n">grayScaleImage</span><span class="o">.</span><span class="n">height</span><span class="p">()),</span><span class="n">grayScaleImage</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MedTreeView.printPreview"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeView.printPreview">[docs]</a>    <span class="k">def</span> <span class="nf">printPreview</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Prints a .png preview of the tree</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">maxSize</span> <span class="o">=</span> <span class="mi">32767</span>
        <span class="c">#First, ensure image is not bigger or equal to 32768 x 32768 pixels, qt&#39;s x11 maximum authorized pixmap size</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">maxSize</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">maxSize</span><span class="p">:</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">173</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">250</span><span class="p">)))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="s">&quot;No preview available&quot;</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Old Method, slow with some kind of trees</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB32</span><span class="p">)</span>
            <span class="c">#pixmap = QtGui.QPixmap(self.sceneRect().width(),self.sceneRect().height())</span>
            <span class="n">painter</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
            <span class="c">#self.render(painter)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">painter</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="n">pixmap</span></div></div>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Undo/Redo system</span>
<span class="sd">&#39;&#39;&#39;</span>
<div class="viewcode-block" id="CommandAddChild"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddChild">[docs]</a><span class="k">class</span> <span class="nc">CommandAddChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the addChild function, hence allowing the undo/redo functionalities</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Paste&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandAddChild.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddChild.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a child to the currently selected graphical representation of a primitive, hence adding it into the model.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="c">#Add primitive to model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiAddChild</span><span class="p">(</span><span class="s">&quot;Control_Nothing&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">countChildren</span><span class="p">())</span>
            <span class="c">#Create graphical primitive</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
                <span class="n">childOffset</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cross</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                        <span class="c">#Child located above has a subTree, compute height of this subTree</span>
                        <span class="n">childOffset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">_calculateAmountOfSpace</span><span class="p">()</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">newGraphicalPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getRow</span><span class="p">()</span><span class="o">+</span><span class="n">childOffset</span><span class="o">/</span><span class="n">glob_ColDist</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">())</span>
                
                <span class="c">#Translate items located below</span>
                <span class="n">yPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">childOffset</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">yPos</span><span class="o">+</span><span class="n">glob_Height</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="n">yPos</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">yPos</span><span class="o">+</span><span class="n">glob_Height</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                            <span class="n">item</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_ColDist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#The added child will be the first child added, create and add</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">newGraphicalPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="n">MedTreeCross</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
            
            <span class="c">#Adjust z value of siblings</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">#Add to scene</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">lookForLineModif</span><span class="p">()</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="c">#A second child was added to the current item, create vertical line</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
            
            
            <span class="c">#Notify view that scene Rect changed(QGraphicsView doesn&#39;t adjust scroll bars when items that are not visible in viewport are translated outside of the last set sceneRect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">updateSceneRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="CommandAddChild.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddChild.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo add child operation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span><span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            </div></div>
<div class="viewcode-block" id="CommandAddMC"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddMC">[docs]</a><span class="k">class</span> <span class="nc">CommandAddMC</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the addChild function, hence allowing the undo/redo functionalities.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">numChild</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Paste&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numChild</span> <span class="o">=</span> <span class="n">numChild</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandAddMC.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddMC.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add numChild child to the current primitive. \n</span>
<span class="sd">        Reason : in switch(switch bins etc), adding numerous child can be useful</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">numChild</span><span class="p">:</span>
                <span class="c">#Create a CommandAdd function and call its redo function</span>
                <span class="c">#CommandAdd object will not interfere with stack since it hasn&#39;t been push on it, but we have to manually call the redo</span>
                <span class="c">#so it is performed the first time</span>
                <span class="n">tmpCommandAdd</span> <span class="o">=</span> <span class="n">CommandAddChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">)</span>
                <span class="n">tmpCommandAdd</span><span class="o">.</span><span class="n">redo</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">numChild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numChild</span><span class="o">-</span><span class="mi">1</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="CommandAddMC.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddMC.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo add child operation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="CommandAddSA"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSA">[docs]</a><span class="k">class</span> <span class="nc">CommandAddSA</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the addSiblingAfter function, hence allowing the undo/redo functionalities</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Paste&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandAddSA.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSA.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a child after the currently selected graphical representation of a primitive, hence adding it into the model</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="n">parentPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span>
            <span class="n">pmtPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
            <span class="n">parentPmt</span><span class="o">.</span><span class="n">guiAddChild</span><span class="p">(</span><span class="s">&quot;Control_Nothing&quot;</span><span class="p">,</span> <span class="n">pmtPos</span><span class="p">)</span>
            <span class="n">childOffset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                    <span class="c">#Child located above has a subTree, compute height of this subTree</span>
                    <span class="n">childOffset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">_calculateAmountOfSpace</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">newGraphicalPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="n">parentPmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">()</span><span class="o">+</span><span class="n">childOffset</span><span class="o">/</span><span class="n">glob_ColDist</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">getRow</span><span class="p">())</span>
            
            <span class="c">#Translate items located below</span>
            <span class="n">yPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">childOffset</span><span class="o">+</span><span class="n">glob_Height</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">yPos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="n">yPos</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">yPos</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_ColDist</span><span class="p">)</span>
            
            <span class="c">#Add to scene</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">(),</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">newGraphicalPmt</span><span class="p">)</span>
            <span class="c">#Adjust z value of siblings</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">pmtPos</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">#Look for branch tag</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">lookForLineModif</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="c">#A second child was added to the current item, create vertical line</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
            
            <span class="c">#Notify view that scene Rect changed(QGraphicsView doesn&#39;t adjust scroll bars when items that are not visible in viewport are translated outside of the last set sceneRect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">updateSceneRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
          </div>
<div class="viewcode-block" id="CommandAddSA.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSA.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo add child operation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="CommandAddSB"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSB">[docs]</a><span class="k">class</span> <span class="nc">CommandAddSB</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the addSiblingBefore function, hence allowing the undo/redo functionalities</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Paste&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandAddSB.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSB.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a child before the currently selected graphical representation of a primitive, hence adding it into the model</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="n">parentPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span>
            <span class="n">pmtPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
            <span class="n">parentPmt</span><span class="o">.</span><span class="n">guiAddChild</span><span class="p">(</span><span class="s">&quot;Control_Nothing&quot;</span><span class="p">,</span> <span class="n">pmtPos</span><span class="p">,</span><span class="s">&quot;shift&quot;</span><span class="p">)</span>
            <span class="c">#Create graphical primitive </span>
            <span class="n">_</span><span class="p">,</span> <span class="n">newGraphicalPmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="n">parentPmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">getRow</span><span class="p">())</span>
            <span class="c">#Translate items located below currentItem&#39;s subTree</span>
            <span class="n">yPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                    <span class="n">yPos</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">_calculateAmountOfSpace</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">yPos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="n">yPos</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">yPos</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_ColDist</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c">#Current Item was first child, take car of its line</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setLine</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_ColDist</span><span class="p">)</span>
            <span class="c">#Add to scene</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">(),</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">,</span><span class="n">newGraphicalPmt</span><span class="p">)</span>
            <span class="c">#Adjust z value of siblings</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">pmtPos</span><span class="p">]:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">zValue</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">#Look for add/remove of branch tags</span>
            <span class="n">newGraphicalPmt</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">lookForLineModif</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="c">#A second child was added to the current item, create vertical line</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
            
            <span class="c">#Notify view that scene Rect changed(QGraphicsView doesn&#39;t adjust scroll bars when items that are not visible in viewport are translated outside of the last set sceneRect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">updateSceneRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="CommandAddSB.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandAddSB.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo add child operation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="CommandCut"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandCut">[docs]</a><span class="k">class</span> <span class="nc">CommandCut</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the cut function, hence allowing the undo/redo functionalities</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Cut&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandCut.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandCut.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Remove item and paste it to clipboard</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="c">#Test if it is root Node</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiCanDeleteChild</span><span class="p">():</span>
                    <span class="c">#Delete child</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiDeleteChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">collapseSubTree</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    
                    <span class="n">yPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span>
                    
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">:</span>
                        <span class="c">#Adjust parent line if child located at position 1 becomes first child</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setLine</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">)),</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">branchTagEditor</span> <span class="o">=</span> <span class="bp">None</span>
                                
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                    <span class="c">#Keep reference on parent</span>
                    <span class="n">parentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span>
                    <span class="c">#Remove Item</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                    
                    <span class="c">#Translate items located below, if necessary</span>
                    <span class="n">translationList</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="n">parentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">yPos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="n">yPos</span><span class="p">)):</span>
                            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">yPos</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                                <span class="n">translationList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                        <span class="c">#Here&#39;s The reason we stock items in a list before moving them:</span>
                        <span class="c">#Presume and item is located at yPos and its parent at yPos-something</span>
                        <span class="c">#This item is moved -glob_ColDist</span>
                        <span class="c">#Presume this item has a child</span>
                        <span class="c">#Its parent is now located at yPos-glob_ColDist, so this item his moved too, hence ending in an extra translation</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">translationList</span><span class="p">:</span>
                            <span class="n">item</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">glob_ColDist</span><span class="p">)</span>
                        <span class="c">#One child left, delete parentLine</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">parentItem</span><span class="o">.</span><span class="n">childrenLine</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c">#In case the deleted child is the last child, look for needed modifications in children line</span>
                            <span class="n">parentItem</span><span class="o">.</span><span class="n">lookForLineModif</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c">#No more children, delete cross</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="n">parentItem</span><span class="o">.</span><span class="n">cross</span><span class="p">)</span>
                        <span class="n">parentItem</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="bp">None</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="c">#Replace model Item by Nothing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
                    <span class="n">pmtPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiSetModelData</span><span class="p">(</span><span class="s">&quot;Control_Nothing&quot;</span><span class="p">,</span><span class="n">pmtPos</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">collapseSubTree</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="c">#Add New Nothing node</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">newSubTree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getRow</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">getColumn</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">getRow</span><span class="p">())</span>
                    <span class="n">newSubTree</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">(),</span><span class="bp">False</span><span class="p">)</span>
                    <span class="n">newSubTree</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">()</span>
                    <span class="c">#Adjust Z values</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newSubTree</span>
                    <span class="n">newSubTree</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">zValue</span><span class="p">())</span>
                    <span class="c">#Remove old Item</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">)</span>
                    
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#root Primitive, clear whole tree</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">()</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s">&quot;Control_Nothing&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="CommandCut.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandCut.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo cut operation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="CommandDropChild"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandDropChild">[docs]</a><span class="k">class</span> <span class="nc">CommandDropChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the dropChild function, hence allowing the undo/redo functionalities.</span>
<span class="sd">    If first ever call to redo, use current tree information to make modifications.</span>
<span class="sd">    Else, just reload the tree using a dom as done in the undo function.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">itemModified</span><span class="p">,</span><span class="n">newPrimitiveName</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s">&quot;Replace child&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#First redo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span> <span class="o">=</span> <span class="n">itemModified</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newPmtName</span> <span class="o">=</span> <span class="n">newPrimitiveName</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandDropChild.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandDropChild.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Replace child primitive by the one being dropped on it</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="c">#Redo automatically called at class creation</span>
            <span class="c">#Test if it is root Node</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="c">#Replace model Item by child</span>
                <span class="n">pmtPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiSetModelData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPmtName</span><span class="p">,</span><span class="n">pmtPos</span><span class="p">)</span>
                <span class="c">#Update Tree</span>
                <span class="n">newItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_updateTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">itemModified</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="n">newItem</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#Item replaced is root primitive</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">()</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPmtName</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="n">mainGroup</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            
            <span class="c">#Notify view that scene Rect changed(QGraphicsView doesn&#39;t adjust scroll bars when items that are not visible in viewport are translated outside of the last set sceneRect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">updateSceneRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="CommandDropChild.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandDropChild.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo replace child operation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="CommandPaste"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandPaste">[docs]</a><span class="k">class</span> <span class="nc">CommandPaste</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class embedding the paste function, hence allowing the undo/redo functionalities.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentView</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="s">&quot;Paste&quot;</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QUndoCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parentView</span>
        <span class="c">#Redo flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c">#Undo info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        
<div class="viewcode-block" id="CommandPaste.redo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandPaste.redo">[docs]</a>    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Paste function.</span>
<span class="sd">        Looks if a MedTreeItem is currently selected and pastes MainEditorWindow&#39;s clipboard content, if there is one, onto currently selected MedTreeItem.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">isRootPmt</span><span class="p">:</span>
                <span class="n">pmtPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChildPos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiReplaceModelData</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span><span class="p">)</span>
                <span class="c">#Update Tree</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_updateTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="n">pmtPos</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">clipboard</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="n">mainGroup</span>
        
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            
            <span class="c">#Notify view that scene Rect changed(QGraphicsView doesn&#39;t adjust scroll bars when items that are not visible in viewport are translated outside of the last set sceneRect)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">updateSceneRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">())</span>
            <span class="c">#Collect info for eventual redos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">_writeDom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">dom</span><span class="o">.</span><span class="n">ownerDocument</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstFlag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#Real redo</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="c">#Model Load</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDom</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
            <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
                <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="CommandPaste.undo"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.CommandPaste.undo">[docs]</a>    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Undo paste operation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c">#Model Load</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">treeEditorPmtModel</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDom</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">mainGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_loadTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">mainGroup</span><span class="p">)</span>
        <span class="n">newCrosses</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">crosses</span> <span class="ow">in</span> <span class="n">newCrosses</span> <span class="p">:</span>
            <span class="n">crosses</span><span class="o">.</span><span class="n">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldCrossState</span><span class="p">[</span><span class="n">newCrosses</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">crosses</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">generalUpdate</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="MedTreeItem"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem">[docs]</a><span class="k">class</span> <span class="nc">MedTreeItem</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is a graphical representation of a xml node in a QGraphicsView.</span>
<span class="sd">    Most of it is reimplemented from QGraphicsWidget.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">position</span><span class="p">,</span><span class="n">dimension</span><span class="p">,</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor</span>
<span class="sd">        </span>
<span class="sd">        :param position: position relative to parent&#39;s graphical object.</span>
<span class="sd">        :param dimension: size of the object.</span>
<span class="sd">        :param parent: QGraphicsView in which this object is going to be shown.</span>
<span class="sd">        :type position: QPoint</span>
<span class="sd">        :type parent: QGraphicsView</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c">#Initialize Variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicalPmtList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c">#Initialize flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptDrops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="o">.</span><span class="n">ItemIsSelectable</span><span class="o">|</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="o">.</span><span class="n">ItemStacksBehindParent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">StrongFocus</span><span class="p">)</span>

<div class="viewcode-block" id="MedTreeItem.setParentItem"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.setParentItem">[docs]</a>    <span class="k">def</span> <span class="nf">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parentItem</span><span class="p">,</span><span class="n">appendToEndOfList</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsWidget.setParentItem(self,parentItem).</span>
<span class="sd">        Parent primitive keeps a list of its  MedTreeItem children.</span>
<span class="sd">        </span>
<span class="sd">        :param parentItem: parent MedTreeItem.</span>
<span class="sd">        :param appendToEndOfList: if set to False, user will have to correctly manage the graphicalPmtList.</span>
<span class="sd">        :type appendToEndOfList: Boolean</span>
<span class="sd">        :type parentItem: MedTreeItem</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">appendToEndOfList</span><span class="p">:</span>
            <span class="n">parentItem</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parentItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;yChanged()&quot;</span><span class="p">),</span><span class="n">parentItem</span><span class="o">.</span><span class="n">lookForLineModif</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="MedTreeItem.boundingRect"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.boundingRect">[docs]</a>    <span class="k">def</span> <span class="nf">boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsWidget.boundingRect(self) virtual function.</span>
<span class="sd">        Required to correctly paint the graphic item.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#The boundingRect coordinates must be in item&#39;s coordinate, hence the (0,0) position.</span>
        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="MedTreeItem.paintHook"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.paintHook">[docs]</a>    <span class="k">def</span> <span class="nf">paintHook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        If an error is found in the model this function is called.</span>
<span class="sd">        Hence, the item is repainted and changes colour, keeping the tree view and the model synced.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        </div>
<div class="viewcode-block" id="MedTreeItem.paint"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Overloaded function(QGraphicsWidget) : painting is done in item coordinate</span>
<span class="sd">        </span>
<span class="sd">        :param painter:</span>
<span class="sd">        :param option:</span>
<span class="sd">        :param widget: see QGraphicsWidget&#39;s doc for details</span>
<span class="sd">        :type widget: Not used</span>
<span class="sd">        :type option: Not used</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        
        <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHints</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="o">.</span><span class="n">Antialiasing</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiIsHighlighted</span><span class="p">():</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
        
        <span class="c">#if pressed, paint thick blue border line</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">currentItem</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">blue</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">:</span>
                    <span class="n">modifiedFont</span> <span class="o">=</span> <span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
                    <span class="n">modifiedFont</span><span class="o">.</span><span class="n">setPointSizeF</span><span class="p">(</span><span class="n">modifiedFont</span><span class="o">.</span><span class="n">pointSizeF</span><span class="p">()</span><span class="o">*</span><span class="mi">140</span><span class="o">/</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">))</span>
                    <span class="n">painter</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">modifiedFont</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            
            <span class="c">#Paint in color if errors, else in black</span>
            <span class="n">colorDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Unknown&quot;</span> <span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">,</span>
                     <span class="s">&quot;Valid&quot;</span> <span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">,</span>
                     <span class="s">&quot;Warning&quot;</span> <span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                     <span class="s">&quot;Error&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">}</span>
            
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">colorDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">getValidityState</span><span class="p">()]),</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">display</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetAttrDisplay</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">:</span>
                    <span class="n">modifiedFont</span> <span class="o">=</span> <span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
                    <span class="n">modifiedFont</span><span class="o">.</span><span class="n">setPointSizeF</span><span class="p">(</span><span class="n">modifiedFont</span><span class="o">.</span><span class="n">pointSizeF</span><span class="p">()</span><span class="o">*</span><span class="mi">140</span><span class="o">/</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">))</span>
                    <span class="n">painter</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">modifiedFont</span><span class="p">)</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">gray</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
                <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
                <span class="n">textWidth</span> <span class="o">=</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">display</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">display</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">140</span> <span class="k">else</span> <span class="mi">140</span>
                
                <span class="n">alignmentFlags</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;br&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="o">|</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignBottom</span><span class="p">,</span>
                                      <span class="s">&quot;bl&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignBottom</span><span class="p">,</span>
                                      <span class="s">&quot;tr&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="o">|</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">,</span>
                                      <span class="s">&quot;tl&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">}</span>
                
                
                <span class="k">if</span> <span class="n">textWidth</span> <span class="o">==</span> <span class="mi">140</span><span class="p">:</span>
                    <span class="n">dotAlignment</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="o">|</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignBottom</span>
                    <span class="k">if</span> <span class="n">display</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;t&quot;</span><span class="p">:</span>
                        <span class="n">dotAlignment</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span><span class="o">|</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span>
                    <span class="k">if</span> <span class="n">display</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;l&quot;</span><span class="p">:</span>
                        <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()),</span><span class="n">dotAlignment</span><span class="p">,</span><span class="s">&quot;...&quot;</span><span class="p">)</span>
                        <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">textWidth</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()),</span><span class="n">alignmentFlags</span><span class="p">[</span><span class="n">display</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">display</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()),</span><span class="n">dotAlignment</span><span class="p">,</span><span class="s">&quot;...&quot;</span><span class="p">)</span>
                        <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">textWidth</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()),</span><span class="n">alignmentFlags</span><span class="p">[</span><span class="n">display</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">display</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
                    <span class="n">rect</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span>
                    <span class="n">rect</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                    <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span><span class="n">alignmentFlags</span><span class="p">[</span><span class="n">display</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">display</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                
                <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">140</span><span class="p">:</span>
                    <span class="n">modifiedFont</span> <span class="o">=</span> <span class="n">painter</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
                    <span class="n">modifiedFont</span><span class="o">.</span><span class="n">setPointSizeF</span><span class="p">(</span><span class="n">modifiedFont</span><span class="o">.</span><span class="n">pointSizeF</span><span class="p">()</span><span class="o">*</span><span class="mi">140</span><span class="o">/</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">))</span>
                    <span class="n">painter</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">modifiedFont</span><span class="p">)</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiname</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MedTreeItem.manageBranchTag"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.manageBranchTag">[docs]</a>    <span class="k">def</span> <span class="nf">manageBranchTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a branch tag to subtree or update one if already present.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="o">.</span><span class="n">updateBranchTag</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">pmtParent</span><span class="o">.</span><span class="n">guiCanHaveBranchTag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span> <span class="o">=</span> <span class="n">MedTreeEditableBranchTag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="o">.</span><span class="n">updateBranchTag</span><span class="p">()</span>
                </div>
<div class="viewcode-block" id="MedTreeItem.manageAsterisk"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.manageAsterisk">[docs]</a>    <span class="k">def</span> <span class="nf">manageAsterisk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Manage asterisk that indicates whether or not primitive has a user comment</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;asterisk&quot;</span><span class="p">):</span>
                <span class="n">newAsteriskItem</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">))</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
                <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">18</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">asterisk</span> <span class="o">=</span> <span class="n">newAsteriskItem</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;asterisk&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asterisk</span><span class="p">)</span>
                <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;asterisk&quot;</span><span class="p">)</span>
                </div>
<div class="viewcode-block" id="MedTreeItem.dumpModelInfos"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.dumpModelInfos">[docs]</a>    <span class="k">def</span> <span class="nf">dumpModelInfos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Debug function.</span>
<span class="sd">        Print self.primitive information in the console.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiDumpModelInfos</span><span class="p">()</span>
    </div>
<div class="viewcode-block" id="MedTreeItem.setPrimitive"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.setPrimitive">[docs]</a>    <span class="k">def</span> <span class="nf">setPrimitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set basePmtModel&#39;s primitive instance associated with this graphical object</span>
<span class="sd">        :param primitive: basePmtModel&#39;s primitive instance</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span> <span class="o">=</span> <span class="n">primitive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">primitive</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;updateBranchTag()&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">manageBranchTag</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="MedTreeItem.shape"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.shape">[docs]</a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView.boundingRect(self) virtual function.</span>
<span class="sd">        Allows the correct propagation of mouse event.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainterPath</span><span class="p">()</span>
        <span class="n">path</span><span class="o">.</span><span class="n">addRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">path</span>
     </div>
<div class="viewcode-block" id="MedTreeItem.getRow"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.getRow">[docs]</a>    <span class="k">def</span> <span class="nf">getRow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function returns self&#39;s relative row</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">())</span><span class="o">/</span><span class="n">glob_ColDist</span>
    </div>
<div class="viewcode-block" id="MedTreeItem.getColumn"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.getColumn">[docs]</a>    <span class="k">def</span> <span class="nf">getColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function returns self&#39;s relative column</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">())</span><span class="o">/</span><span class="n">glob_RowDist</span>
    </div>
<div class="viewcode-block" id="MedTreeItem.collapseSubTree"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.collapseSubTree">[docs]</a>    <span class="k">def</span> <span class="nf">collapseSubTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">updateLayout</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This functions prepares the folding of a branch.</span>
<span class="sd">        First, it looks for the MedTreeCross associated with the branch.</span>
<span class="sd">        Once found, it sets its activation state to False.</span>
<span class="sd">        Afterward, It calls it&#39;s _expOrCollapse function that will allow the propagation of the activation status.</span>
<span class="sd">        Finally, if needed, it will call a layoutUpdate on the MedTreeCross.</span>
<span class="sd">        </span>
<span class="sd">        :param updateLayout: If false, we want to perform this action without updating the general layout of the Tree.</span>
<span class="sd">        :type updateLayout: Boolean</span>
<span class="sd">        </span>
<span class="sd">        By example, when we add a new SubTree to a Primitive, we will first collapse the subTree. Since this new subTree isn&#39;t yet</span>
<span class="sd">        part of the Tree, we don&#39;t want the general Layout to be updated, hence the utility of the updateLayout parameter. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">item</span><span class="o">.</span><span class="n">_expOrCollapse</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">updateLayout</span><span class="p">:</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">_layout_update</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">_calculateAmountOfSpace</span><span class="p">()</span>
            </div>
<div class="viewcode-block" id="MedTreeItem.expandSubTree"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.expandSubTree">[docs]</a>    <span class="k">def</span> <span class="nf">expandSubTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">updateLayout</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This functions prepares the expand of a branch.</span>
<span class="sd">        First, it looks for the MedTreeCross associated with the branch.</span>
<span class="sd">        Once found, it sets its activation state to True.</span>
<span class="sd">        Afterward, it will call a layoutUpdate on the MedTreeCross.</span>
<span class="sd">        Finally, It calls it&#39;s _expOrCollapse function that will allow the propagation of the activation status.</span>
<span class="sd">        </span>
<span class="sd">        :param updateLayout: If false, we want to perform this action without updating the general layout of the Tree.</span>
<span class="sd">        :type updateLayout: Boolean</span>
<span class="sd">        </span>
<span class="sd">        Note: _expOrCOllapse, if compared to the collapseSubTree function, is called after the update : since the layoutUpdate function</span>
<span class="sd">        calls the _calculateAmoutOfSpace function which itself relies on the visible status to calculate the amount of space used or released by a</span>
<span class="sd">        collapse/expand action, we first have to calculate the amount of space that will be used by the &quot;invisible subTree&quot; before setting the branch and all of its subTree visible</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">childItems</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeCross</span><span class="p">):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span> <span class="n">updateLayout</span><span class="p">:</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">_layout_update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">_expOrCollapse</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">return</span>
        </div>
<div class="viewcode-block" id="MedTreeItem.lookForLineModif"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.lookForLineModif">[docs]</a>    <span class="k">def</span> <span class="nf">lookForLineModif</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function allowing a MedTreeItem with multiple line objects to update its vertical line.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setLine</span><span class="p">(</span><span class="mi">175</span><span class="p">,</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="n">glob_Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="MedTreeItem.moveBy"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.moveBy">[docs]</a>    <span class="k">def</span> <span class="nf">moveBy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsWidget.moveBy(self, dx, dy) virtual function.</span>
<span class="sd">        Function calls parent&#39;s class moveBy implementation.</span>
<span class="sd">        </span>
<span class="sd">        :param dx: Number of points to move horizontally</span>
<span class="sd">        :param dy: Number of points to move vertically</span>
<span class="sd">        :type dx: QReal</span>
<span class="sd">        :type dy: QReal</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MedTreeItem</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="MedTreeItem.reInitialize"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeItem.reInitialize">[docs]</a>    <span class="k">def</span> <span class="nf">reInitialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Method called by the undo function.</span>
<span class="sd">        Allows a tree with invalid primitive pointer to correctly re-initialize.</span>
<span class="sd">        </span>
<span class="sd">        :param primitive: new primitive to set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pmt</span> <span class="o">=</span> <span class="n">primitive</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
            <span class="n">child</span><span class="o">.</span><span class="n">reInitialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">child</span><span class="p">)))</span>
            </div>
    <span class="k">def</span> <span class="nf">_cloneNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parentView</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Manually clone node, since Qt doesn&#39;t support such operation.</span>
<span class="sd">        Recursively call function on child nodes.</span>
<span class="sd">        </span>
<span class="sd">        :param parentView:</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">clone</span> <span class="o">=</span> <span class="n">MedTreeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">(),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_Width</span><span class="p">,</span><span class="n">glob_Height</span><span class="p">),</span><span class="n">parentView</span><span class="p">)</span>
        <span class="n">clone</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isVisible</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">graphicalChild</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
            <span class="n">cloneChild</span> <span class="o">=</span> <span class="n">graphicalChild</span><span class="o">.</span><span class="n">_cloneNode</span><span class="p">(</span><span class="n">parentView</span><span class="p">)</span>
            <span class="n">cloneChild</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">clone</span><span class="p">)</span>
        
        <span class="n">clone</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zValue</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;parentLine&quot;</span><span class="p">):</span>
            <span class="c">#Tests if parentLine attribute exists since root object doesn&#39;t have any</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">parentLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">line</span><span class="p">(),</span><span class="n">clone</span><span class="p">)</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">parentLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
        <span class="c"># if hasattr(self,&quot;choiceList&quot;):</span>
            <span class="c">#Tests if choiceList attribute exists since root object doesn&#39;t have any</span>
            <span class="c">#  clone.choiceList = MedTreeArrow(QtCore.QPointF(125,38),clone) </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">:</span>
            <span class="c">#Self has cross</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="n">MedTreeCross</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">glob_RowDist</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">parentView</span><span class="p">)</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">clone</span><span class="p">)</span>
            <span class="c">#Since self has cross, self might have children line</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span><span class="p">:</span>
                <span class="n">clone</span><span class="o">.</span><span class="n">childrenLine</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsLineItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">line</span><span class="p">(),</span><span class="n">clone</span><span class="p">)</span>
                <span class="n">clone</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">isVisible</span><span class="p">())</span>
                <span class="n">clone</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DashLine</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="p">:</span>
            <span class="c">#self has Edtior</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">branchTagEditor</span> <span class="o">=</span> <span class="n">MedTreeEditableBranchTag</span><span class="p">(</span><span class="n">clone</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">branchTagEditor</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
            <span class="c">#Self has branch info</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">(),</span><span class="n">clone</span><span class="p">)</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;Helvetica&quot;</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>          
            <span class="n">clone</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextWidth</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">clone</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">setTextInteractionFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoTextInteraction</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;asterisk&quot;</span><span class="p">):</span>
            <span class="n">newAsteriskItem</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="n">clone</span><span class="p">)</span>
            <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">))</span>
            <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="n">newAsteriskItem</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="s">&quot;DejaVu [Serif]&quot;</span><span class="p">,</span><span class="mi">18</span><span class="p">))</span>
            <span class="n">clone</span><span class="o">.</span><span class="n">asterisk</span> <span class="o">=</span> <span class="n">newAsteriskItem</span>
        
        <span class="k">return</span> <span class="n">clone</span>
    </div>
<div class="viewcode-block" id="MedTreeCross"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross">[docs]</a><span class="k">class</span> <span class="nc">MedTreeCross</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is a graphical representation of a cross/minus sign.</span>
<span class="sd">    Most of it is reimplemented from QGraphicsWidget.</span>
<span class="sd">    It is used as a graphical way for the user to fold/unfold parts of the tree.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">position</span><span class="p">,</span><span class="n">dimension</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor</span>
<span class="sd">        </span>
<span class="sd">        :param position: position relative to parent&#39;s graphical object.</span>
<span class="sd">        :param dimension: size of the object.</span>
<span class="sd">        :param parent: QGraphicsView in which this object is going to be shown.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentView</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        
<div class="viewcode-block" id="MedTreeCross.paint"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Overloaded function(QGraphicsWidget) : painting is done in item coordinate.</span>
<span class="sd">        </span>
<span class="sd">        :param painter:</span>
<span class="sd">        :param option:</span>
<span class="sd">        :param widget: see QGraphicsWidget&#39;s doc for details.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
            <span class="c">#Paint a &quot;-&quot;s operator</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
           
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Unknown&quot;</span> <span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">,</span>
                     <span class="s">&quot;Valid&quot;</span> <span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">green</span><span class="p">,</span>
                     <span class="s">&quot;Warning&quot;</span> <span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">yellow</span><span class="p">,</span>
                     <span class="s">&quot;Error&quot;</span><span class="p">:</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">}</span>
            <span class="c">#Paint a &quot;+&quot; operator</span>
            <span class="c">#Draw Cross the color of the subtree</span>
            <span class="n">eventColor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">_findWorstEvent</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">colorDict</span><span class="p">[</span><span class="n">eventColor</span><span class="p">]),</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          </div>
<div class="viewcode-block" id="MedTreeCross.boundingRect"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross.boundingRect">[docs]</a>    <span class="k">def</span> <span class="nf">boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView.boundingRect(self) virtual function.</span>
<span class="sd">        Required to correctly paint the graphic item.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#The boundingRect coordinates must be in item&#39;s coordinate, hence the (0,0) position.</span>
        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
    </div>
<div class="viewcode-block" id="MedTreeCross.shape"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross.shape">[docs]</a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsView.shape(self) virtual function.</span>
<span class="sd">        Allows the correct propagation of mouse event.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainterPath</span><span class="p">()</span>
        <span class="n">path</span><span class="o">.</span><span class="n">addRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">path</span>
    </div>
<div class="viewcode-block" id="MedTreeCross.mousePressEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function changes activation status and forwards it to its parent children.</span>
<span class="sd">        It also allows the appropriate geometry change(updating the position) of the Tree.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsWidget&#39;s documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_expOrCollapse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layout_update</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layout_update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_expOrCollapse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="p">)</span>
                
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsWidget</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="MedTreeCross.fakePress"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeCross.fakePress">[docs]</a>    <span class="k">def</span> <span class="nf">fakePress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function changes activation status, adjust layout if not hidden yet.</span>
<span class="sd">        Called by the redo/undo system, to adjuste a newly created tree to a previous/posterior state.</span>
<span class="sd">        </span>
<span class="sd">        :param state: Tells if the state is enabled or not.</span>
<span class="sd">        :param state: Boolean</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_expOrCollapse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activated</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layout_update</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">activated</span> <span class="o">=</span> <span class="n">state</span>
        </div>
    <span class="k">def</span> <span class="nf">_expOrCollapse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">activationStatus</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function loops through all children and change their visible state(if child is a MedTreeItem).</span>
<span class="sd">        Qt forwards invisible state to children.</span>
<span class="sd">        Visible state is also forwarded unless the child has explicitly been set invisible(Qt behavior).</span>
<span class="sd">        </span>
<span class="sd">        :param activationStatus: Modify the visiblity of an item.</span>
<span class="sd">        :type activationStatus: Boolean</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">:</span>
            <span class="c">#If item in graphicsGroup is a MedTreeItem</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">activationStatus</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">childrenLine</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">activationStatus</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">_layout_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">negFactor</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function loops through all items located under the cross after a collapse or expand action</span>
<span class="sd">        and finds the items with a parent located higher in the tree</span>
<span class="sd">        </span>
<span class="sd">        :param negFactor: is the multiplication factor(-1 or 1) to apply</span>
<span class="sd">        :type negFactor: Int</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="mi">35</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">()</span><span class="o">.</span><span class="n">sceneRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">())):</span>
            <span class="c">#if item isn&#39;t visible, then it&#39;s part of the branch we collapsed or that we are going to expand</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">MedTreeItem</span><span class="p">):</span>
                    <span class="c">#Test if MedTreeItem is a child item of a MedTreeItem higher in the tree(smaller y in scene coordinate)</span>
                    <span class="c">#If so, start propagating the geometry change from this item</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="mi">35</span><span class="p">:</span>
                        <span class="n">item</span><span class="o">.</span><span class="n">moveBy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">negFactor</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculateAmountOfSpace</span><span class="p">())</span>
                
    <span class="k">def</span> <span class="nf">_calculateAmountOfSpace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">         This function calculates the amount of space released or used by an expand or collapse action.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">lastTreeElement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c">#Look if current element has a cross and if it is activated</span>
            <span class="k">if</span> <span class="n">lastTreeElement</span><span class="o">.</span><span class="n">cross</span> <span class="ow">and</span> <span class="n">lastTreeElement</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                <span class="n">lastTreeElement</span> <span class="o">=</span> <span class="n">lastTreeElement</span><span class="o">.</span><span class="n">graphicalPmtList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="n">lastTreeElement</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">scenePos</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
              </div>
<div class="viewcode-block" id="MedTreeEditableBranchTag"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag">[docs]</a><span class="k">class</span> <span class="nc">MedTreeEditableBranchTag</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is a graphical representation of a switch value for primitives Switch, SwitchBins and DynnamicBranch.</span>
<span class="sd">    When such primitives have switch values, those values are located left to the MedTreeItem, aligned with the horizontal branch line  .</span>
<span class="sd">    Most of it is reimplemented from QGraphicsTextItem.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor</span>
<span class="sd">        </span>
<span class="sd">        :param position: parent is the line located right to the EditableBranchTag.</span>
<span class="sd">        :param parent: text is the switch value.</span>
<span class="sd">        :type text: String</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateTextWidth</span><span class="p">()</span>
        
<div class="viewcode-block" id="MedTreeEditableBranchTag.calculateTextWidth"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.calculateTextWidth">[docs]</a>    <span class="k">def</span> <span class="nf">calculateTextWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calculates the width taken by the switch value and adjusts position.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="o">-</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span><span class="o">-</span><span class="mi">35</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="MedTreeEditableBranchTag.updateBranchTag"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.updateBranchTag">[docs]</a>    <span class="k">def</span> <span class="nf">updateBranchTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This slot is called when a primitive switch values have been modified.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetBranchTag</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetBranchTag</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculateTextWidth</span><span class="p">()</span>   
    </div>
<div class="viewcode-block" id="MedTreeEditableBranchTag.focusOutEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.focusOutEvent">[docs]</a>    <span class="k">def</span> <span class="nf">focusOutEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsTextItem.focusOutEvent(self,event) virtual function.</span>
<span class="sd">        Leave Edit Mode and update.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsTextItem documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">textInteractionFlags</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">TextEditorInteraction</span><span class="p">:</span>
            <span class="c">#Update primitive and size/position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiSetBranchTag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculateTextWidth</span><span class="p">()</span>
        
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">focusOutEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="MedTreeEditableBranchTag.mousePressEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Reimplementation of QGraphicsTextItem.mousePressEvent(self,event) virtual function.</span>
<span class="sd">        Enter Edit Mode if branch tag doesn&#39;t refer to a reference attribute.</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsTextItem documentation for more information.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">pmt</span><span class="o">.</span><span class="n">guiGetBranchTag</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setTextInteractionFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">TextEditorInteraction</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setTextInteractionFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoTextInteraction</span><span class="p">)</span>
            
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="MedTreeEditableBranchTag.paint"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Overloaded function(QGraphicsTextItem) : painting is done in item coordinate.</span>
<span class="sd">        </span>
<span class="sd">        :param painter:</span>
<span class="sd">        :param option:</span>
<span class="sd">        :param widget: see QGraphicsTextItem&#39;s doc for details</span>
<span class="sd">        :type painter: QPainter</span>
<span class="sd">        :type option: QStyleOptionGraphicsItem</span>
<span class="sd">        :type: widget: QWidget</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">)))</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasFocus</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(),</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span><span class="s">&quot;!&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;!&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultTextColor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">black</span><span class="p">))</span>
        
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MedTreeEditableBranchTag.keyPressEvent"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeEditableBranchTag.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Overloaded function(QGraphicsTextItem) : readjust size when text is edited</span>
<span class="sd">        </span>
<span class="sd">        :param event: see QGraphicsTextItem&#39;s doc for details.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateTextWidth</span><span class="p">()</span>
        </div></div>
<div class="viewcode-block" id="MedTreeComboBox"><a class="viewcode-back" href="../../../../editor/AdvancedTreeEditor.html#LSD_inputGUI.src.editor.AdvancedTreeEditor.MedTreeComboBox">[docs]</a><span class="k">class</span> <span class="nc">MedTreeComboBox</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is a comboBox embed in a ProxyWidget.</span>
<span class="sd">    Most of its is reimplemented from QtGui.QGraphicsProxyWidget</span>
<span class="sd">    It is used as a graphical way for the user to present a list of primitive that can replace its associated node</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor</span>
<span class="sd">        @param choices : list of possible replacing primitives</span>
<span class="sd">        @param parent : proxyWidget this item is embed in</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QComboBox</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyParent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">StrongFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s">&quot;activated(QString)&quot;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">proxyParent</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">parentItem</span><span class="p">()</span><span class="o">.</span><span class="n">parentView</span><span class="o">.</span><span class="n">_updateTreeHook</span><span class="p">)</span>
    </div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">LSD-inputGUI 3.5 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Mathieu Boily.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>